<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.290">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2014-05-16">

<title>L’Œuvre - Project to implement remote PHP web client/ MSSQL database server network setup</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-T2KJQMELJT"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-T2KJQMELJT', { 'anonymize_ip': true});
</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">L’Œuvre</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target=""><i class="bi bi-question-circle" role="img">
</i> 
 <span class="menu-text"> </span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml" rel="" target=""><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Project to implement remote PHP web client/ MSSQL database server network setup</h1>
  <div class="quarto-categories">
    <div class="quarto-category">article</div>
    <div class="quarto-category">datascience</div>
    <div class="quarto-category">php</div>
    <div class="quarto-category">mysql</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 16, 2014</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">August 16, 2015</p>
    </div>
  </div>
    
  </div>
  

</header>

<p><em>Posted on Friday, May 16th, 2014 at 2:43 pm</em></p>
<p>For students learning data science/analytics, accessing data sets stored from databases in remote servers is a necessary skill. People in corporations/institutions have Systems Administrators to set up most of the interfaces for such purposes. However knowing how such a process is setup is a good knowledge. Here PHP is used to demonstrate database access.</p>
<p>Although this project is not related to data science/analytics, it will give a good hands-on experience of client/server networking. These are mere guidelines and not details as specific options &amp; settings will depend on the version of the software &amp; components.</p>
<p>Pre-requisites: Fairly good understanding of computer hardware especially networking, Windows operating system, drivers &amp; software installation. Hardware/Networking</p>
<p>Physical: Atleast two computers with Ethernet/WiFi capability and a wireless/wired router.</p>
<p>Final Setup: Ability to create Workgroups &amp; shared folders. Also ability to ping &amp; telnet the remote computers/servers. Server Setup</p>
<p>There are many versions &amp; editions MSSQL depending on user requirements (The Developer Edition is best for learning &amp; academic use). For data mining features, SQL Server Analysis Services(SSAS) must be installed. To install OLTP/DW AdventureWorks sample databases, enable <code>FILESTREAM</code> and make sure the SQL Full-text Filter Daemon Launcher service is running.</p>
<ol type="1">
<li>If you have the space, do a full install of every feature. It will make it easier to troubleshoot problems.</li>
<li>Create a MSSQL user exclusively for remote access. <a href="http://technet.microsoft.com/en-us/library/aa337545.aspx" class="uri">http://technet.microsoft.com/en-us/library/aa337545.aspx</a></li>
<li>Allow remote connection to MSSQL. <a href="http://technet.microsoft.com/en-us/library/ms191464.aspx" class="uri">http://technet.microsoft.com/en-us/library/ms191464.aspx</a></li>
<li>Enable Shared Memory, TCP/IP, pipes <a href="http://technet.microsoft.com/en-us/library/ms181035.aspx" class="uri">http://technet.microsoft.com/en-us/library/ms181035.aspx</a></li>
<li>In the Windows Firewall, allow incoming/outgoing connections for port 1433 (default MSSQL port.) <a href="http://blogs.msdn.com/b/walzenbach/archive/2010/04/14/how-to-enable-remote-connections-in-sql-server-2008.aspx" class="uri">http://blogs.msdn.com/b/walzenbach/archive/2010/04/14/how-to-enable-remote-connections-in-sql-server-2008.aspx</a></li>
</ol>
<p>Final Setup: From the Command Prompt in the client, execute ping dbpcip and telnet dbpcip 1433 where dbpcip is the IP address of MSSQL machine. If you can connect with both the commands, the client/server networking is probably working. Although accessing the datebase &amp; tables finally depends on the permissions assigned to the remote user. Client Setup</p>
<p>Keep these details in mind before starting installation. 1) Some of the types of PHP functions for access to MSSQL. This article only discusses <code>mssql_()</code> and <code>sqldrv_()</code>.</p>
<pre><code>`mssql_()` Supported by PHP 5.2 (php52) and lower. MSSQL Driver for PHP (SSDPHP) not required
`sqldrv_()` Supported by PHP 5.3 (php53) and higher. SSDPHP required.
`pdo_sqlsrv_()` Supported by php52 and higher. SSDPHP required.
`pdo_odbc_()` Supported by php51 and higher. SSDPHP not required.</code></pre>
<ol start="2" type="1">
<li><p>SQL Server Native Client (SSNC): This is needed by PHP to access MSSQL Server. SSNC2008: installs on winxp SSNC2012: does not install on winxp. php52: requires atleast SSNC2008 php53: requires atleast SSNC2012</p></li>
<li><p>Problem: php53 onwards requires SSNC2012, but SSNC2012 does not work on winxp. Also php53 does not support <code>mssql_()</code> functions.</p></li>
</ol>
<p>Solution: SSNC2008 works on winxp. Use php 5.2.13 to 5.2.17 as php52 requires SSNC2008. Also php 5.2.x supports <code>mssql_()</code>functions and sqldrv_() functions if you install the SSDPHP 2.0. Client software</p>
<ol type="1">
<li>Internet Information Services (IIS): Official Documentation: <a href="https://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/iiiisin2.mspx?mfr=true" class="uri">https://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/iiiisin2.mspx?mfr=true</a></li>
</ol>
<p>Step-by-step illustrated guide: Follow until step 10 <a href="http://www.wikihow.com/Configure-IIS-for-Windows-XP-Pro" class="uri">http://www.wikihow.com/Configure-IIS-for-Windows-XP-Pro</a></p>
<p>You can test if it is working by opening the <a href="http://localhost/" class="uri">http://localhost/</a> address on the web browser. You should also test it on a remote computer using <a href="http://clientip/" class="uri">http://clientip/</a></p>
<p>Final Setup: Windows Version: XP IIS Version: 5.1</p>
<ol start="2" type="1">
<li>FastCGI:</li>
</ol>
<p>FastCGI helps IIS work better with PHP. Install the one which is compatible with your version of IIS &amp; OS. Official source: <a href="http://www.iis.net/downloads/microsoft/fastcgi-for-iis" class="uri">http://www.iis.net/downloads/microsoft/fastcgi-for-iis</a></p>
<p>Final Setup:fcgisetup_1.5_rtw_x86.msi</p>
<ol start="3" type="1">
<li>PHP installation:</li>
</ol>
<ol type="a">
<li>Steps to installing PHP with IIS are explained in &lt;www.php.net/manual/en/install.windows.iis6.php&gt;</li>
<li>5.2 and lower <code>mssql_()</code>documentation <a href="http://www.php.net/manual/en/book.mssql.php" class="uri">http://www.php.net/manual/en/book.mssql.php</a></li>
<li>5.3 and higher sqlsrv_() documentation <a href="http://www.php.net/manual/en/book.sqlsrv.php" class="uri">http://www.php.net/manual/en/book.sqlsrv.php</a></li>
<li>5.2 and higher pdo_sqlsrv() documentation <a href="http://www.php.net/manual/en/ref.pdo-sqlsrv.php" class="uri">http://www.php.net/manual/en/ref.pdo-sqlsrv.php</a></li>
<li>5.1 and higher pdo_odbc() documentation <a href="http://www.php.net/manual/en/ref.pdo-odbc.php" class="uri">http://www.php.net/manual/en/ref.pdo-odbc.php</a></li>
</ol>
<p>Final Setup: php-5.2.17-nts-Win32-VC6-x86.msi</p>
<ol start="4" type="1">
<li>MSSQL Driver for PHP:</li>
</ol>
<p>Official Documentation: <a href="http://technet.microsoft.com/en-us/library/dn425064%28v=sql.10%29.aspx" class="uri">http://technet.microsoft.com/en-us/library/dn425064%28v=sql.10%29.aspx</a></p>
<p>Installation help: <a href="http://www.iis.net/learn/application-frameworks/install-and-configure-php-on-iis/install-the-sql-server-driver-for-php" class="uri">http://www.iis.net/learn/application-frameworks/install-and-configure-php-on-iis/install-the-sql-server-driver-for-php</a></p>
<p>Final Setup: SQLSRV20.exe</p>
<ol start="5" type="1">
<li>SQL Server Native Client:</li>
</ol>
<p>Use this page to decide what components are needed for your setup. <a href="http://msdn.microsoft.com/en-us/library/cc296170%28SQL.105%29.aspx" class="uri">http://msdn.microsoft.com/en-us/library/cc296170%28SQL.105%29.aspx</a></p>
<p>Final Setup: sqlncli2k8r2x86.msi</p>
<ol start="6" type="1">
<li>Overview: The entire process can be very broadly summarised as:</li>
</ol>
<p>IIS -&gt; FastCGI -&gt; PHP 5.3 -&gt; sqlsrv_() -&gt; SSDPHP 3.0 -&gt; SSNC -&gt; MSSQL IIS -&gt; FastCGI -&gt; PHP 5.2 -&gt; sqlsrv_() -&gt; SSDPHP 2.0 -&gt; SSNC -&gt; MSSQL IIS -&gt; FastCGI -&gt; PHP 5.2 -&gt; <code>mssql_()</code>-&gt; No SSDPHP -&gt; SSNC -&gt; MSSQL Testing the final setup:</p>
<ol type="1">
<li>PHP System Information Test: If PHP is properly installed, the following code should execute:</li>
</ol>
<p>SOURCE CODE:</p>
<pre><code>&lt;?php echo phpinfo(); ?&gt;</code></pre>
<p>You should get PHP system information which includes information about msql_() and sqlsrv_() extensions. Only relevant partial output shown below.</p>
<p>OUTPUT:</p>
<pre><code>
    
        Registered PHP Streams 
            php, file, data, http, ftp, compress.zlib, compress.bzip2, 
        https, ftps, zip, sqlsrv   
    




cgi-fcgi


    
        Directive
            Local Value
            Master Value
    

    
        cgi.check_shebang_line
            1
            1
    

    
        cgi.fix_pathinfo
            1
            1
    

    
        cgi.force_redirect
            0
            0
    

    
        cgi.nph
            0
            0
    

    
        cgi.redirect_status_env
            no value
            no value
    

    
        cgi.rfc2616_headers
            0
            0
    

    
        fastcgi.impersonate
            1
            1
    

    
        fastcgi.logging
            0
            0
    



msql


    
        MSQL Support 
            enabled 
    

    
        Allow Persistent Links 
            yes 
    

    
        Persistent Links 
            0/unlimited 
    

    
        Total Links 
            0/unlimited 
    



mssql


    
        MSSQL Support
            enabled
    

    
        Active Persistent Links 
            0 
    

    
        Active Links 
            0 
    

    
        Library version 
            7.0 
    




    
        Directive
            Local Value
            Master Value
    

    
        mssql.allow_persistent
            On
            On
    

    
        mssql.batchsize
            0
            0
    

    
        mssql.compatability_mode
            Off
            Off
    

    
        mssql.connect_timeout
            5
            5
    

    
        mssql.datetimeconvert
            On
            On
    

    
        mssql.max_links
            Unlimited
            Unlimited
    

    
        mssql.max_persistent
            Unlimited
            Unlimited
    

    
        mssql.max_procs
            Unlimited
            Unlimited
    

    
        mssql.min_error_severity
            10
            10
    

    
        mssql.min_message_severity
            10
            10
    

    
        mssql.secure_connection
            Off
            Off
    

    
        mssql.textlimit
            Server default
            Server default
    

    
        mssql.textsize
            Server default
            Server default
    

    
        mssql.timeout
            60
            60
    



pdo_sqlsrv


    
        pdo_sqlsrv support
            enabled
    




    
        Directive
            Local Value
            Master Value
    

    
        pdo_sqlsrv.log_severity
            0
            0
    



sqlsrv


    
        sqlsrv support
            enabled
    




    
        Directive
            Local Value
            Master Value
    

    
        sqlsrv.LogSeverity
            0
            0
    

    
        sqlsrv.LogSubsystems
            0
            0
    

    
        sqlsrv.WarningsReturnAsErrors
            On
            On
    
</code></pre>
<ol start="2" type="1">
<li>Remote MSSQL Access Test: If phpinfo() indicates that all the drivers &amp; extensions are installed properly, then test to see if the database server &amp; client are properly registered.</li>
</ol>
<p>SOURCE CODE:</p>
<pre><code>
&lt;?php
$serverName = "dbpcip, 1433"; //serverName\instanceName, portNumber (default is 1433)
$connectionInfo = array( "Database"=&gt;"master", "UID"=&gt;"userName", "PWD"=&gt;"passWord");
$conn = sqlsrv_connect( $serverName, $connectionInfo);

if( $conn ) {
     echo "Connection established.
";
}else{
     echo "Connection could not be established.
";
     die( print_r( sqlsrv_errors(), true));
}

if( $client_info = sqlsrv_client_info( $conn)) {
    foreach( $client_info as $key =&gt; $value) {
        echo $key.": ".$value."
";
    }
} else {
    echo "Error in retrieving client info.
";
}


$server_info = sqlsrv_server_info( $conn);
if( $server_info )
{
    foreach( $server_info as $key =&gt; $value) {
       echo $key.": ".$value."
";
    }
} else {
      die( print_r( sqlsrv_errors(), true));
}
?&gt;</code></pre>
<p>OUTPUT:</p>
<pre><code>Connection established.


    
        Parameter
            Value
    

    
        DriverDllName:
            sqlncli10.dll
    

    
        DriverODBCVer:
            03.52
    

    
        DriverVer:
            10.50.1600
    

        
        ExtensionVer:
            2.0.1802.200
    

        
        SQLServerVersion:
            10.50.1600
    

        
        SQLServerName:
            DBPC</code></pre>
<ol start="3" type="1">
<li>Test of SQL Query: Once a connection is established, the final test is to see whether query execution is possible or not. This is a quick crude code. But the fact that it retrieves data from master.dbo.spt_monitor table shows the setup &amp; the connection works.</li>
</ol>
<p>SOURCE CODE:</p>
<pre><code>&lt;?php
$serverName = "dbpcip, 1433"; //serverName\instanceName, portNumber (default is 1433)
$connectionInfo = array( "Database"=&gt;"master", "UID"=&gt;"userName", "PWD"=&gt;"passWord");
$conn = sqlsrv_connect( $serverName, $connectionInfo);

error_reporting(-1);


if( $conn ) {
     echo "Connection established.
";
}else{
     echo "Connection could not be established.
";
     die( print_r( sqlsrv_errors(), true));
}
/* SQL Query */
$sql="select * from dbo.spt_monitor";
$results = sqlsrv_query( $conn, $sql );
if( $results === false) {
    die( print_r( sqlsrv_errors(), true) );
}
    echo "MSSQL master.dbo.spt_monitor TABLE
";
        echo "
            &lt;table border=1&gt;
            &lt;tr&gt;
                &lt;th&gt;cpu_busy&lt;/th&gt;
                &lt;th&gt;io_busy&lt;/th&gt;
                &lt;th&gt;idle&lt;/th&gt;
                &lt;th&gt;pack_received&lt;/th&gt;
                &lt;th&gt;pack_sent&lt;/th&gt;
                &lt;th&gt;connections&lt;/th&gt;
                &lt;th&gt;pack_errors&lt;/th&gt;
                &lt;th&gt;total_read&lt;/th&gt;
                &lt;th&gt;total_write&lt;/th&gt;
                &lt;th&gt;total_errors&lt;/th&gt;
             &lt;/tr&gt;";
    while ($row = sqlsrv_fetch_array($results))
    {
                $cpu_busy=$row[1];
                $io_busy=$row[2];
                $idle=$row[3];
                $pack_received=$row[4];
                $pack_sent=$row[5];
                $connections=$row[6];
                $pack_errors=$row[7];
                $total_read=$row[8];
                $total_write=$row[9];
                $total_errors=$row[10];
             
    echo "
            &lt;tr&gt;
                &lt;td&gt;$cpu_busy&lt;/td&gt;;
                &lt;td&gt;$io_busy&lt;/td&gt;;
                &lt;td&gt;$idle&lt;/td&gt;;
                &lt;td&gt;$pack_received&lt;/td&gt;;
                &lt;td&gt;$pack_sent&lt;/td&gt;;
                &lt;td&gt;$connections&lt;/td&gt;;
                &lt;td&gt;$pack_errors&lt;/td&gt;;
                &lt;td&gt;$total_read&lt;/td&gt;;
                &lt;td&gt;$total_write&lt;/td&gt;;
                &lt;td&gt;$total_errors&lt;/td&gt;;
            &lt;/tr&gt;";
    }
    echo "&lt;/table&gt;";
    ?&gt;</code></pre>
<p>OUTPUT:</p>
<pre><code>Connection established.

MSSQL master.dbo.spt_monitor TABLE

; ; ; ; ; ; ; ; ; ;

            

                
                    cpu_busy
                        io_busy
                        idle
                        pack_received
                        pack_sent
                        connections
                        pack_errors
                        total_read
                        total_write
                        total_errors
                

                
                    9
                        7
                        792
                        28
                        28
                        14
                        0
                        0
                        0
                        0
                </code></pre>
<ol start="4" type="1">
<li>Incorrect SSDPHP version:</li>
</ol>
<p>Problem: If you use php53/SSDPHP 3.0 code but use SSNC2008 instead of SSNC 2012, you get an error message.</p>
<p>Could not connect. Array ( [0] =&gt; Array ( [0] =&gt; IMSSP [SQLSTATE] =&gt; IMSSP [1] =&gt; -49 [code] =&gt; -49 [2] =&gt; This extension requires the Microsoft SQL Server 2012 Native Client. Access the following URL to download the Microsoft SQL Server 2012 Native Client ODBC driver for x86: <a href="http://go.microsoft.com/fwlink/?LinkId=163712" class="uri">http://go.microsoft.com/fwlink/?LinkId=163712</a> [message] =&gt; This extension requires the Microsoft SQL Server 2012 Native Client. Access the following URL to download the Microsoft SQL Server 2012 Native Client ODBC driver for x86: <a href="http://go.microsoft.com/fwlink/?LinkId=163712" class="uri">http://go.microsoft.com/fwlink/?LinkId=163712</a> ) [1] =&gt; Array ( [0] =&gt; IM002 [SQLSTATE] =&gt; IM002 [1] =&gt; 0 [code] =&gt; 0 [2] =&gt; [Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified [message] =&gt; [Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified ) )</p>
<p>Solution: Install php52/SSDPHP 2.0 &amp; SSNC2008</p>
<p><strong>Summary:</strong></p>
<p>Although this project takes a lot of time to setup, troubleshoot &amp; tweak all the settings, the end result is a client/server setup one can experiment with. Once the database server is setup properly, various types of software can be configured to retrieve/store data. PHP can be used to create web applications for doing data analysis using MSSQL.</p>
<p>To access data from MSSQL using php52, <code>mssql_()</code> functions is used. But php53 onwards uses only <code>sqldrv_()</code> functions to access MSSQL. Hence it is better to learn <code>sqldrv_()</code> functions. However knowing how to use the older functions will help when dealing with legacy systems having php52.</p>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>